[1m============================= test session starts ==============================[0m
platform darwin -- Python 3.13.3, pytest-8.4.2, pluggy-1.6.0 -- /Users/kostas/Documents/Projects/openai-cs-agents-demo/python-backend/.venv/bin/python3.13
cachedir: .pytest_cache
rootdir: /Users/kostas/Documents/Projects/openai-cs-agents-demo/python-backend
configfile: pytest.ini
plugins: cov-6.0.0, anyio-4.11.0, Faker-33.1.0, xdist-3.6.0, asyncio-0.25.0, mock-3.14.0
asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=function
[1mcollecting ... [0mcollected 9 items

tests/e2e/test_e2e_full_stack.py::TestTriageAgent::test_basic_greeting [32mPASSED[0m[32m [ 11%][0m
tests/e2e/test_e2e_full_stack.py::TestCostEstimation::test_cost_estimation_flow [32mPASSED[0m[32m [ 22%][0m
tests/e2e/test_e2e_full_stack.py::TestProjectStatus::test_project_status_flow [32mPASSED[0m[32m [ 33%][0m
tests/e2e/test_e2e_full_stack.py::TestAppointmentBooking::test_appointment_booking_flow [32mPASSED[0m[32m [ 44%][0m
tests/e2e/test_e2e_full_stack.py::TestGuardrails::test_relevance_guardrail [32mPASSED[0m[32m [ 55%][0m
tests/e2e/test_e2e_full_stack.py::TestGuardrails::test_jailbreak_guardrail [32mPASSED[0m[32m [ 66%][0m
tests/e2e/test_e2e_full_stack.py::TestFrontendIntegration::test_frontend_proxy [32mPASSED[0m[32m [ 77%][0m
tests/e2e/test_e2e_full_stack.py::TestPerformance::test_response_time [32mPASSED[0m[32m [ 88%][0m
tests/e2e/test_e2e_full_stack.py::TestMultiTurnConversation::test_context_preservation [31mFAILED[0m[31m [100%][0m/Users/kostas/Documents/Projects/openai-cs-agents-demo/python-backend/.venv/lib/python3.13/site-packages/pytest_cov/plugin.py:355: CovFailUnderWarning: Coverage failure: total of 35 is less than fail-under=80
  warnings.warn(CovFailUnderWarning(message), stacklevel=1)
[31m[1m
ERROR: Coverage failure: total of 35 is less than fail-under=80
[0m

=================================== FAILURES ===================================
[31m[1m_____________ TestMultiTurnConversation.test_context_preservation ______________[0m
[1m[31mtests/e2e/test_e2e_full_stack.py[0m:419: in test_context_preservation
    [0mresponse2 = send_chat_message(message2, conversation_id)[90m[39;49;00m
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mtests/e2e/test_e2e_full_stack.py[0m:42: in send_chat_message
    [0mresponse.raise_for_status()[90m[39;49;00m
[1m[31m.venv/lib/python3.13/site-packages/requests/models.py[0m:1026: in raise_for_status
    [0m[94mraise[39;49;00m HTTPError(http_error_msg, response=[96mself[39;49;00m)[90m[39;49;00m
[1m[31mE   requests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: http://127.0.0.1:8000/chat[0m
----------------------------- Captured stdout call -----------------------------

================================================================================
TEST 8: MULTI-TURN CONVERSATION
================================================================================

üì§ Turn 1: 'I want to build a house'

üì§ Turn 2: 'What are the advantages of timber construction?'
--------------------------- Captured stdout teardown ---------------------------

‚è±Ô∏è  Test duration: 5.04s

---------- coverage: platform darwin, python 3.13.3-final-0 ----------
Name                                         Stmts   Miss  Cover   Missing
--------------------------------------------------------------------------
__init__.py                                      1      0   100%
api.py                                         220    144    35%   122, 132, 150-161, 165-173, 180-181, 185-188, 201-209, 214-223, 229-247, 270-476, 493, 508-541
main.py                                        145     73    50%   54-56, 88-157, 170, 190-236, 255, 265-275, 312-320, 349, 358-394, 413-414, 419-420, 460-462, 497-499, 547-549, 590-592, 631-634
production_config.py                           122    122     0%   5-282
tests/__init__.py                                0      0   100%
tests/conftest.py                               76     37    51%   48, 54, 74-76, 86, 103, 109-111, 121-133, 139-150, 160, 169, 180, 194-200, 205
tests/e2e/__init__.py                            0      0   100%
tests/e2e/conftest.py                           10      0   100%
tests/e2e/test_e2e_full_stack.py               210     14    93%   51, 63-64, 87-88, 422-432, 441-443
tests/integration/__init__.py                    0      0   100%
tests/integration/test_api_endpoints.py        207    207     0%   5-356
tests/integration/test_main_integration.py     143    143     0%   8-304
tests/unit/__init__.py                           0      0   100%
--------------------------------------------------------------------------
TOTAL                                         1134    740    35%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml

[31m[1mFAIL Required test coverage of 80% not reached. Total coverage: 34.74%
[0m============================= slowest 10 durations =============================
9.47s call     tests/e2e/test_e2e_full_stack.py::TestCostEstimation::test_cost_estimation_flow
4.99s call     tests/e2e/test_e2e_full_stack.py::TestProjectStatus::test_project_status_flow
4.96s call     tests/e2e/test_e2e_full_stack.py::TestMultiTurnConversation::test_context_preservation
3.30s call     tests/e2e/test_e2e_full_stack.py::TestAppointmentBooking::test_appointment_booking_flow
2.33s call     tests/e2e/test_e2e_full_stack.py::TestGuardrails::test_relevance_guardrail
1.99s call     tests/e2e/test_e2e_full_stack.py::TestTriageAgent::test_basic_greeting
1.59s call     tests/e2e/test_e2e_full_stack.py::TestFrontendIntegration::test_frontend_proxy
1.47s call     tests/e2e/test_e2e_full_stack.py::TestPerformance::test_response_time
1.07s call     tests/e2e/test_e2e_full_stack.py::TestGuardrails::test_jailbreak_guardrail
0.07s setup    tests/e2e/test_e2e_full_stack.py::TestTriageAgent::test_basic_greeting
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m tests/e2e/test_e2e_full_stack.py::[1mTestMultiTurnConversation::test_context_preservation[0m - requests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: http://127.0.0.1:8000/chat
[31m========================= [31m[1m1 failed[0m, [32m8 passed[0m[31m in 32.01s[0m[31m =========================[0m
